---

  - name: Fetch base path
    set_fact:
        base_path: {{ hostvars['morpheus_git_path']['morpheus_git_path'] }}/DL-LTI-Openshift
        
  - name: populate service facts
    service_facts:

  - debug:
      var: ansible_facts.services["{{ item }}"].state
    with_items:
      - tftp.service
      - dnsmasq.service
      - matchbox.service
      - xinetd.service

  - name: copy ignition files to matchbox
    copy:
      src: "{{ base_path }}/playbooks/roles/generate_ignition_files/ignitions/bootstrap.ign"
      dest: /var/lib/matchbox/ignition/
      remote_src: yes
      owner: root
      group: root
      mode: 775

  - name: copy ignition files to matchbox
    copy:
      src: "{{ base_path }}/playbooks/roles/generate_ignition_files/ignitions/master.ign"
      dest: /var/lib/matchbox/ignition/
      remote_src: yes
      owner: root
      group: root
      mode: 775

  - name: copy ignition files to matchbox
    copy:
      src: "{{ base_path }}/playbooks/roles/generate_ignition_files/ignitions/worker.ign"
      dest: /var/lib/matchbox/ignition/
      remote_src: yes
      owner: root
      group: root
      mode: 775

